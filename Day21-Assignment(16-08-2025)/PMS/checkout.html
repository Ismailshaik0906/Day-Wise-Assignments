<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - PMS</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background: #f4f6f9;
    }
    .navbar-brand {
      font-family: 'Brush Script MT', cursive;
      font-size: 1.8rem;
    }
    .cart-badge {
      background: red;
      color: white;
      border-radius: 50%;
      padding: 4px 8px;
      font-size: 0.8rem;
      margin-left: 5px;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Product Management</a>
      <div class="d-flex">
        <a class="btn btn-primary me-2" href="user.html">Product List</a>
        <a class="btn btn-info me-2" href="cart.html">
          Cart <span id="cart-count" class="cart-badge">0</span>
        </a>
        <a class="btn btn-warning me-2" href="checkout.html">Checkout</a>
        <a class="btn btn-danger" href="index.html">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Checkout Section -->
  <div class="container mt-5">
    <h2 class="mb-4 text-center">Checkout</h2>
    <div class="table-responsive">
      <table class="table table-bordered table-striped">
        <thead class="table-dark">
          <tr>
            <th>Product Name</th>
            <th>Price (₹)</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="cart-items"></tbody>
        <tfoot>
          <tr>
            <th>Total</th>
            <th id="total-price">₹0</th>
            <th></th>
          </tr>
        </tfoot>
      </table>
    </div>
    <div class="text-center">
      <button class="btn btn-success btn-lg" onclick="placeOrder()">Place Order</button>
    </div>
  </div>

  <!-- Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Script -->
  <script>
    // ✅ Update cart count in navbar
    function updateCartCount() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      document.getElementById("cart-count").textContent = cart.length;
    }

    // ✅ Load cart items
    function loadCart() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      const cartItems = document.getElementById("cart-items");
      const totalPriceElem = document.getElementById("total-price");

      cartItems.innerHTML = "";
      let total = 0;

      cart.forEach((item, index) => {
        total += item.price;
        cartItems.innerHTML += `
          <tr>
            <td>${item.name}</td>
            <td>₹${item.price}</td>
            <td>
              <button class="btn btn-danger btn-sm" onclick="removeItem(${index})">
                <i class="bi bi-trash"></i> Remove
              </button>
            </td>
          </tr>
        `;
      });

      totalPriceElem.textContent = "₹" + total;
      updateCartCount();
    }

    // ✅ Remove item from cart
    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1); 
      localStorage.setItem("cart", JSON.stringify(cart));
      loadCart();
    }

    // ✅ Place order
    function placeOrder() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
      }
      alert("Order placed successfully! ✅");
      localStorage.removeItem("cart");
      loadCart();
    }

    // ✅ Initialize
    loadCart();
  </script>
</body>
</html>
